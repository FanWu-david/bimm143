---
title: "Class 05: Data Viz with ggplot"
author: "Fan Wu(PID:A15127541)"
format: gfm
---

Today, we are exploring the **ggplot** package and how to make nice figures in R.

There are lots of ways to make figures and plot in R. 
These include:

- so called "base" R
- and add on packages like **ggplot2**

Here is a simple "base" R plot.

```{r}
head(cars)
```

We can simply pass this to the `plot()` function.

```{r}
plot(cars)
```

> Key-point: Base R is quick but not so nice looking in some folks eyes

Let's see how we can plot this with **ggplot2**

1st, I need to install this add-on package.

For any package, we use the `install.pacakges()`function. 
- **WE DO THIS IN THE CONSOLE, NOT our report**. 
This is is a one time only deal

2nd, We need to load the package with the `library()` function every time we want to use it. 

```{r}
library(ggplot2)
ggplot(cars)
```

Every ggplot is composed of at least 3 layers: 

- **data** (i.e. data.frame w/ the things you want to plot)
-aesthetics: **aes()** that map the columns of data to your plot features(i.e. aesthetics)
-geometry like **geom_point()** that decides how the plot appears

```{r}
ggplot(cars) +
  aes(x=speed, y=dist) +
  geom_point()
```

```{r}
hist(cars$speed)
```

> Key point: For simple graphs, **base R** is simpler and quicker
But as things get more custom and complex, **ggplot2** wins 

Let's add more layers to our ggplot

Add a line showing the relationship between x and y
Add a title
Add custom axis labels "Speed(MPH)" and "Distance(ft)"
Change the theme...

```{r}
ggplot(cars) +
  aes(x=speed, y=dist) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE) +
  labs(title = "Silly plot of Speed vs Stoping distance", 
       x = "Speed(MPH)", 
       y = "Distance(ft)") +
  theme_minimal()
```

## Going further

Read some gene expression data

```{r}
url <- "https://bioboot.github.io/bimm143_S20/class-material/up_down_expression.txt"
genes <- read.delim(url)

head(genes)
```

> Q1. How many genes are in this dataset? 
  each row contain info for a gene
  
```{r}
nrow(genes)
```

> Q2. How many "up" regulated genes are there?
we can sum all the true as true=1, false=0, to get the number of  "up " regulated genes

```{r}
sum(genes$State == "up")
```

A useful function for counting "up" occurances of things in a vector is the `table()` function

```{r}
table(genes$State)
```

try graph

```{r}
P <- ggplot(genes) +
  aes(x=Condition1, 
      y=Condition2,
      color = State) +
  geom_point()

P
```


```{r}
P + 
  scale_color_manual(values = c("green","yellow","red")) +
  labs(title = "Expression changes upon drug treatment",
       x = "Control (no drug)", 
       y = "Treatment (with drug)") +
  theme_minimal()
```

## More Plotting

Read in the gapminder dataset

```{r}
# File location online
url <- "https://raw.githubusercontent.com/jennybc/gapminder/master/inst/extdata/gapminder.tsv"

gapminder <- read.delim(url)
```

Let's have a peak

```{r}
head(gapminder, 10)
```

```{r}
tail(gapminder)
```
> Q4. How many different countries are in this dataset?

```{r}
nrow(gapminder)
```
length () tell us the size of the vector
```{r}
length(table(gapminder$country))
```
>Q5. How many different continent values are in this dataset?

```{r}
length(table(gapminder$continent))
```
unique() returns the unique elements of a vector or the unique rows of a data frame, removing any duplicates
```{r}
unique(gapminder$continent)
```

Make version 1 figure
```{r}
ggplot(gapminder) +
  aes(x=gdpPercap,
      y=lifeExp,
      col = continent) +
  geom_point()
```

```{r}
ggplot(gapminder) +
  aes(x=gdpPercap,
      y=lifeExp,
      col = continent,
      label = country) +
  geom_point() +
  geom_text()
```

I can use **ggrepel** package to make more sensible labels here
by typing `install.packges()` in R console.

```{r}
library(ggrepel)

ggplot(gapminder) +
  aes(x=gdpPercap,
      y=lifeExp,
      col = continent,
      label = country) +
  geom_point() +
  geom_text_repel()
```
I want a seperate pannel per continent
```{r}
ggplot(gapminder) +
  aes(x=gdpPercap,
      y=lifeExp,
      col = continent,
      label = country) +
  geom_point() +
  facet_wrap(~continent)

```

## Summary
ggplot is just adding one layer after another in plots

ggplot2 offers several advantages over base R plotting:

1. Layered Grammar: ggplot uses a consistent, layered approach, letting you build plots by adding layers for data, aesthetics, and geometric objects. This makes complex plots easier to construct and modify [[1]](https://drive.google.com/file/d/1BYSWJLROqxA1YpuDhJkzUolhiZqiOOKg/view?usp=drivesdk), [[2]](https://drive.google.com/file/d/1tFqKg9_nhVMmKYfiM1CQKDS2PmPwLh8n/view?usp=drivesdk), [[3]](https://drive.google.com/file/d/1Clw2_EJ_hY3USNwObiPnxpIQIfirxfW0/view?usp=drivesdk), [[5]](https://drive.google.com/file/d/15xXaaIcCWOc_x1gJLdySWOd_sfMXTiaw/view?usp=drivesdk), [[4]](https://drive.google.com/file/d/1FDBbIi2Rlw2In9mClB7Mub8oUPgx6y8h/view?usp=drivesdk).

2. Publication Quality: ggplot produces visually appealing, publication-ready graphics with sensible defaults, making it easier to create beautiful figures without extensive tweaking [[1]](https://drive.google.com/file/d/1BYSWJLROqxA1YpuDhJkzUolhiZqiOOKg/view?usp=drivesdk), [[2]](https://drive.google.com/file/d/1tFqKg9_nhVMmKYfiM1CQKDS2PmPwLh8n/view?usp=drivesdk), [[3]](https://drive.google.com/file/d/1Clw2_EJ_hY3USNwObiPnxpIQIfirxfW0/view?usp=drivesdk).

3. Customization: While base R gives pixel-level control, ggplot makes it much easier to customize and combine plot elements, legends, and themes, especially for complex visualizations [[1]](https://drive.google.com/file/d/1BYSWJLROqxA1YpuDhJkzUolhiZqiOOKg/view?usp=drivesdk), [[2]](https://drive.google.com/file/d/1tFqKg9_nhVMmKYfiM1CQKDS2PmPwLh8n/view?usp=drivesdk), [[3]](https://drive.google.com/file/d/1Clw2_EJ_hY3USNwObiPnxpIQIfirxfW0/view?usp=drivesdk).

4. Consistency: ggplot uses a unified syntax for different plot types, reducing the need to learn many separate functions as in base R [[1]](https://drive.google.com/file/d/1BYSWJLROqxA1YpuDhJkzUolhiZqiOOKg/view?usp=drivesdk), [[2]](https://drive.google.com/file/d/1tFqKg9_nhVMmKYfiM1CQKDS2PmPwLh8n/view?usp=drivesdk), [[3]](https://drive.google.com/file/d/1Clw2_EJ_hY3USNwObiPnxpIQIfirxfW0/view?usp=drivesdk), [[5]](https://drive.google.com/file/d/15xXaaIcCWOc_x1gJLdySWOd_sfMXTiaw/view?usp=drivesdk).

5. Reproducibility: ggplot code is modular and scriptable, making it easy to reproduce and automate plots for different datasets [[1]](https://drive.google.com/file/d/1BYSWJLROqxA1YpuDhJkzUolhiZqiOOKg/view?usp=drivesdk), [[2]](https://drive.google.com/file/d/1tFqKg9_nhVMmKYfiM1CQKDS2PmPwLh8n/view?usp=drivesdk).

What do you think is the biggest advantage for your own work?